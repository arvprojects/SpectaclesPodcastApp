# Establishing Spotify Connection

This guide will walk you through the steps required to set up a Spotify connection and run your project in Lens Studio.

### Table of Contents
1. [Prerequisites](#prerequisites)
2. [Step 1: Create a Spotify Developer App](#step-1-create-a-spotify-developer-app)
3. [Step 2: Get Access Token](#step-2-get-access-token)
5. [Step 3: Run Script](#step-3-run-script)

---

## Prerequisites

Before you start, make sure you have the following:
- A [Spotify Developer](https://developer.spotify.com/) account. (Premium Subscription Required)
- Lens Studio installed on your computer.

---

## Step 1: Create a Spotify Developer App

1. Go to the [Spotify Developer Dashboard](https://developer.spotify.com/dashboard/applications).
2. Click on **Create an App**.
3. Fill in the required fields (App name, description, etc.) For redirect URL, use **ngrok** to create a personal public URL. 
4. Click **Create**.
5. After the app is created, take note of your **Client ID** and **Client Secret** from the dashboard.

---

## Step 2: Get Access Token

To access user-specific data (like the playback state), you'll need to use the Spotify OAuth flow to get an `access_token`. 

### 1. Generate Authorization URL

Copy and paste this URL into your browser, replacing the placeholders with your `CLIENT_ID` and `REDIRECT_URI`.

```
https://accounts.spotify.com/authorize?client_id=YOUR_CLIENT_ID&response_type=code&redirect_uri=YOUR_REDIRECT_URI&scope=user-read-playback-state
```

This will redirect the user to Spotify's authorization page. After the user authorizes the app, they will be redirected back to your specified `REDIRECT_URI` with an authorization `code`.

### 2. Exchange Authorization Code for Access Token

Use the following `curl` command (or a similar HTTP tool) to exchange the authorization code for an access token:

```bash
curl -X POST "https://accounts.spotify.com/api/token" \
     -H "Content-Type: application/x-www-form-urlencoded" \
     -d "grant_type=authorization_code&code=AUTHORIZATION_CODE&redirect_uri=YOUR_REDIRECT_URI&client_id=YOUR_CLIENT_ID&client_secret=YOUR_CLIENT_SECRET"
```

This will return a response containing the `access_token` and `refresh_token`. Youâ€™ll use the `access_token` to make API requests.

---

## Step 3: Run Script
Replace the access token with your generated access token.


### Troubleshooting
- If you get an error related to token expiration, regenerate the `access_token` using the `refresh_token`.
- Make sure that your `access_token` has the required `user-read-playback-state` scope.

---

### Additional Notes
- You can customize the script to fetch other types of user data from Spotify by modifying the API endpoint and scope as needed.
- Make sure to regularly refresh your `access_token` as it expires after 1 hour.
